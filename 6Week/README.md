# 6 Week

* * *

# 쉘과 명령어 사용

* * *

## 목차
1. [쉘 이란?](#01)

2. [쉘의 기능](#02)

3. [전면 처리와 후면 처리](#03)

4. [입출력 재지정](#04)

5. [여러 개 명령어 실행](#05)

6. [파일 이름 대치와 명령어 대치](#06)

* * *

<h2 id='01'>쉘 이란?</h2>

- 쉘이란 무엇인가?
  - 쉘의 역할
    - 쉘은 사용자와 운영체제 사이에 창구 역할을 하는 소프트웨어
    - 명령어 처리기 (command processor)
    - 사용자로부터 명령어를 입력받아 이를 처리한다.
    
- 쉘의 종류
  - 유닉스/리눅스에서 사용 가능한 쉘의 종류
    
    |쉘의 종류|쉘 실행 파일|
    |---|---|
    |본 쉘|/bin/sh|
    |콘 쉘|/bin/ksh|
    |C 쉘|/bin/csh|
    |Bash|/bin/bash|
    |tcsh|/bin/tcsh|

  - 본 쉘 (Bourne Shell)
    - 벨연구소의 스티븐 본 (Stephen Bourne)에 의해 개발됨
    - 유닉스에서 기본 쉘로 사용됨
  
  - 콘 쉘 (Korn Shell)
    - 1980년대에는 역시 벨연구소에서 본 쉘을 확장해서 만듦
 
  - Bash (Bourne again Shell)
    - GNU 에서 본 쉘을 확장하여 개발한 쉘
    - 리눅스 및 맥OS X에서 기본 쉘로 사용되면서 널리 보급됨
    - Bash 명령어의 구문은 본 쉘 명령어 구문을 확장함
 
  - C 쉘 (C Shell)
    - 버클리대학의 빌 조이(Bill Joy)에 의해 개발됨
    - 쉘의 핵심 기능 위에 C 언어의 특징을 많이 포함함
    - BSD 계열의 유닉스에서 많이 사용됨
    - 최근에 이를 개선한 tcsh 이 개발되어 사용됨
      
- 로그인 쉘
  - 로그인 하면 자동으로 실행되는 쉘
  - 보통 시스템관리자가 계정을 만들 때 로그인 쉘 지정

- 로그인 쉘 변경
  - 쉘 변경 : `$ csh`
    
  - 로그인 쉘 변경 : `$ chsh`
 
* * * 

<h2 id='02'>쉘의 기능</h2>

- 주요 기능
  - 명령어 처리
    - 사용자가 입력한 명령을 해석하고 적절한 프로그램을 실행
      
  - 시작 파일
    - 로그인할 때 실행되어 사용자별로 맞춤형 환경 설정
      
  - 스크립트
    - 쉘 자체 내의 프로그래밍 기능

- 실행 절차
  
  1. 시작 파일을 읽고 실행한다.
 
  2. 프롬프트를 출력하고 사용자 명령을 기다린다.
 
  3. 사용자 명령을 실행한다.
 
  - Control + D 를 누르면 종료되고 아니면 다시 2번으로 돌아간다.

- 환경 변수
  - 환경변수 설정법 : `$ (환경변수 명) = (문자열)`
    - 환경변수의 값을 문자열로 설정한다.
   
  - 환경변수 보기 : `$ env`
 
  - 사용자 정의 환경 변수
    ```
    $ MESSAGE=hello
    $ export MESSAGE
    ```

- 쉘의 시작 파일 (start-up file)
  - 시작 파일
    - 쉘마다 시작될 떄 자동으로 실행되는 고유의 시작 파일
    - 주로 사용자 환경을 설정하는 역할을 하며 환경설정을 위해서 환경변수에 적절한 값을 설정한다.
   
  - 시스템 시작 파일
    - 시스템의 모든 사용자에게 적용되는 공통적인 설정
    - 환경변수 설정, 명령어 경로 설정, 환영 메세지 출력 등

  - 사용자 시작 파일
    - 사용자 홈 디렉터리에 있으며 각 사용자에게 적용되는 설정
    - 환경변수 설정, 프롬프트 설정, 명령어 경로 설정, 명령어 이명 설정 등 <br />

      <table>
        <tr>
          <th>
            쉘의 종류
          </th>
          <th>
            시작파일 종류
          </th>
          <th>
            시작파일 이름
          </th>
          <th>
            실행 시기
          </th>
        </tr>
        
        <tr>
          <td rowspan="2">
            본 쉘
          </td>
          <td>
            시스템 시작파일
          </td>
          <td>
            /etc/profile
          </td>
          <td>
            로그인
          </td>
        </tr>
    
        <tr>
          <td>
            사용자 시작파일
          </td>
          <td>
            ~/.profile
          </td>
          <td>
            로그인
          </td>
        </tr>
    
        <tr>
          <td rowspan="4">
            Bash 쉘
          </td>
          <td>
            시스템 시작파일
          </td>
          <td>
            /etc/profile
          </td>
          <td>
            로그인
          </td>
        </tr>
    
        <tr>
          <td>
            사용자 시작파일
          </td>
          <td>
            ~/.bash_profile
          </td>
          <td>
            로그인
          </td>
        </tr>
    
        <tr>
          <td>
            사용자 시작파일
          </td>
          <td>
            ~/.bashrc
          </td>
          <td>
            로그인, 쉘 시작
          </td>
        </tr>
    
        <tr>
          <td>
            시스템 시작파일
          </td>
          <td>
            /etc/bash.bashrc
          </td>
          <td>
            로그인
          </td>
        </tr>
    
        <tr>
          <td rowspan="4">
            C 쉘
          </td>
          <td>
            시스템 시작파일
          </td>
          <td>
            /etc/.login
          </td>
          <td>
            로그인
          </td>
        </tr>
    
        <tr>
          <td>
            사용자 시작파일
          </td>
          <td>
            ~/.login
          </td>
          <td>
            로그인
          </td>
        </tr>
    
        <tr>
          <td>
            사용자 시작파일
          </td>
          <td>
            ~/.cshrc
          </td>
          <td>
            로그인, 쉘 시작
          </td>
        </tr>
    
        <tr>
          <td>
            사용자 시작파일
          </td>
          <td>
            ~/.logout
          </td>
          <td>
            로그아웃
          </td>
        </tr>
      </table>

* * *

<h2 id='03'>전면 처리와 후면 처리</h2>

- 전면 처리 VS 후면 처리
  - 전면 처리
    - 입력된 명령어를 전면에서 실행하고 쉘은 명령어 실행이 끝날 때까지 기다린다.
    - `$ (명령어)`
  
  - 후면 처리
    - 명령어를 후면에서 실행하고 전면에서는 다른 작업을 실행하여 동시에 여러 작업을 수행할 수 있다.
    - `$ (명령어) &`

- 후면 처리 예
  ```
  $ (sleep 100; echo done) &
  [1] 77
  $ find . -name test.c -print &
  [2] 79
  ```
  
- 후면 작업 확인 : `$ jobs [%작업번호]`
  - 후면에서 실행되고 있는 작업들을 리스트 한다. 작업 번호를 명시하면 해당 작업만 리스트 한다.
    
  ```
  $ jobs
  [1]-  Running                 ( sleep 100; echo done ) &
  [2]+  Done                    find . -name test.c -print

  $ jobs %1
  [1]+  Running                 ( sleep 100; echo done ) &
  ```

- 후면 작업을 전면 작업으로 전환 : `$ fg [%작업번호]`
  - 작업번호에 해당하는 후면 작업을 전면 작업으로 전환시킨다.
    
  ```
  $ fg %1
  ( sleep 100; echo done )
  ```

* * *

<h2 id="04">입출력 재지정</h2>

- 출력 재지정 (output redirection) : `$ 명령어 > 파일`
  - 명령어의 표준출력을 모니터 대신에 파일에 저장한다.
  
  ```
  $ ls -asl > ls.txt
  $ cat ls.txt
  total 4
  0 drwxr-xr-x 1 skrmsp0423 skrmsp0423  512 Apr 24 20:13 .
  0 drwxr-xr-x 1 skrmsp0423 skrmsp0423  512 Apr 24 20:06 ..
  0 -rw-r--r-- 2 skrmsp0423 skrmsp0423    3 Apr 19 20:42 hi.txt
  0 -rw-r--r-- 2 skrmsp0423 skrmsp0423    3 Apr 19 20:42 hi2.txt
  0 lrwxrwxrwx 1 skrmsp0423 skrmsp0423    6 Apr 19 20:55 hi3.txt -> hi.txt
  0 -rw-r--r-- 1 skrmsp0423 skrmsp0423    0 Apr 24 20:13 ls.txt
  4 -rw-r--r-- 1 skrmsp0423 skrmsp0423 1376 Apr 19 20:40 practiceVi
  ```

- 출력 재지정 이용: 간단한 파일 만들기 `$ cat > 파일`
  - 표준입력 내용을 모두 파일에 저장한다. 파일이 없으면 새로 만든다.
  ```
  $ cat > list.txt
  Hi !
  This is the first list.
  ^D
  ```

- 두 개의 파일을 붙여서 새로운 파일 만들기 : `$ cat 파일1 파일2 > 파일3`
  - 파일 1과 파일 2의 내용을 붙여서 새로운 파일 3을 만들어 준다.
  ```
  $ cat list1.txt list2.txt > list3.txt
  Hi !
  This is the first list.
  Hello !
  This is the second list.
  ```
 
- 출력 추가 : `$ 명령어 >> 파일`
  - 명령어의 표준출력을 모니터 대신에 파일에 추가한다.
  ```
  $ date >> list1.txt
  $ cat list1.txt
  Hi !
  This is the first list.
  Thu Apr 24 20:20:50 KST 2025
  ```

- 입력 재지정 (input redirection) : `$ 명령어 < 파일`
  - 명령어의 표준입력을 키보드 대신에 파일에서 받는다.
  ```
  $ wc < list1.txt
  3 13 58
  ```

- 문서 내 입력 (hero document) : `$ 명령어 << 단어`
  - 명령어의 표준입력을 키보드 대신에 단어와 단어 사이의 입력 내용으로 받는다.
  ```
  $ wc << END
  > hello !
  > word count
  > END
   2  4 19
  ```

- 오류 재지정 : `$ 명령어 2> 파일`
  - 명령어의 표준오류를 모니터 대신에 파일에 저장한다.

  - 명령어의 실행결과
    - 표준출력 (standard output) : 정상적인 실행의 출력
    - 표준오류 (standard error) : 오류 메세지 출력
   
  ```
  $ ls -l /bin/usr 2> err.txt
  $ cat err.txt
  ls: cannot access /bin/usr: No such file or directory
  ```

- 파이프
  - 현재 디렉터리 내의 파일 이름들을 내림차순 정렬해서 보여주기
  ```
  $ ls > ls.txt
  $ sort -r < ls.txt
  ```

  - 사용법 : `$ 명령어1 | 명령어2`
    - 명령어1의 표준출력이 파이프를 통해 명령어2의 표준입력이 된다.
    ```
    $ ls | sort -r
    ls.txt
    list3.txt
    list2.txt
    list1.txt
    list.txt
    ```

- 파이프 사용 예
  - 로그인 된 사용자 수 출력
  ```
  $ who | wc -l
  0
  ```

  - 특정 디렉터리 내의 파일의 개수 출력
  ```
  $ ls (디렉터리) | wc -w
  ```

- 입출력 재지정 관련 명령어 요약

  |명령어 사용법|의미|
  |---|---|
  |명령어 > 파일|명령어의 표준출력을 모니터 대신에 파일에 추가한다.|
  |명령어 >> 파일|명령어의 표준출력을 모니터 대신에 파일에 추가한다.|
  |명령어 < 파일|명령어의 표준입력을 키보드 대신에 파일에서 받는다.|
  |명령어 << 단어 ... 단어|표준입력을 키보드 대신에 단어와 단어 사이의 입력 내용으로 받는다.|
  |명령어 2> 파일|명령어의 표준오류를 모니터 대신에 파일에 저장한다.|
  |명령어1 \| 명령어2|명령어1 의 표준출력이 파이프를 통해 명령어2 의 표준입력이 된다.|
  |cat 파일1 파일2 > 파일3|파일1 과 파일2 의 내용을 붙여서 새로운 파일3 을 만들어준다.|

* * *

<h2 id="05">여러 개 명령어 실행</h2>

- 명령어 열 (command sequence) : `$ 명령어1; ...; 명령어n`
  - 나열된 명령어들을 순차적으로 실행한다.
  ```
  $ date; pwd; ls
  Thu Apr 24 20:38:35 KST 2025
  /home/skrmsp0423
  0404  prac
  ```

- 명령어 그룹 (command group) : `$ (명령어1; ...; 명령어n)`
  - 나열된 명령어들을 하나의 그룹으로 묶어 순차적으로 실행한다.
  ```
  $ date; pwd; ls > out1.txt
  Thu Apr 24 20:40:28 KST 2025
  /home/skrmsp0423/prac
  $ cat out1.txt
  hi.txt
  hi2.txt
  hi3.txt

  $ (date; pwd; ls) > out2.txt
  Thu Apr 24 20:41:03 KST 2025
  /home/skrmsp0423/prac
  hi.txt
  hi2.txt
  hi3.txt
  ```

- 조건 명령어 열 (conditional command sequence) : `$ 명령어1 && 명령어2` or `$ 명령어1 || 명령어2`
  - 명령어1 이 성공적으로 실행되면 명령어2 가 실행되고, 그렇지 않으면 명령어2 가 실행되지 않는다.
  ```
  $ gcc myprog.c && a.out
  ```

  - 명령어1 이 실패하면 명령어2 가 실행되고, 그렇지 않으면 명령어2 가 실행되지 않는다.
  ```
  $ gcc myprog.c || echo 컴파일 실패
  gcc: error: myprog.c: No such file or directory
  gcc: fatal error: no input files
  compilation terminated.
  컴파일 실패
  ```

- 여러 개 명령어 사용 요약

  |명령어 사용법|의미|
  |---|---|
  |명령어1; ...; 명령어n|나열된 명령어들을 순차적으로 실행한다.|
  |(명령어1; ...; 명령어n|나열된 명령어들을 하나의 그룹으로 묶어 순차적으로 실행한다.|
  |명령어1 && 명령어2|명령어1 이 실행되고 명령어 2가 실행된다. 명령어1 이 실행되지 않으면 명령어2 도 실행되지 않는다.|
  |명령어1 || 명령어2|명령어1 이 실패하면 명령어 2가 실행된다. 명령어1 이 실행되면 명령어 2가 실행되지 않는다.|

* * *

<h2 id="06">파일 이름 대치와 명령어 대치</h2>

- 파일 이름 대치
  - 대표문자를 이용한 파일 이름 대치
    - 대표문자를 이용하여 한 번에 여러 파일들을 나타냄
    - 명령어 실행 전에 대표문자가 나타내는 파일 이름들로 먼저 대치하고 실행
      
    |대표문자|의미|
    |---|---|
    |*|빈 스트링을 포함하여 임의의 스트링을 나타냄|
    |?|임의의 한 문자를 나타냄|
    |[..]|대괄호 사이의 문자 중 하나를 나타내며 부분범위 사용 가능함.|

- 명령어 대치 (command substitution)
  - 명령어를 실행할 때 다른 명령어의 실행 결과를 이용
    - \`명령어\` 부분은 그 명령어의 실행 결과로 대치된 후에 실행
   
  - 예
    ```
    $ echo 현재 시간은 `date`
    현재 시간은 Thu Apr 24 20:54:18 KST 2025
    ```

- 따옴표 사용
  - 따옴표를 이용하여 대치 기능을 제한
  ```
  $ echo 3 * 4 = 12
  3 hi.txt hi2.txt hi3.txt ... out1.txt out2.txt practiceVi 4 = 12
  $ echo "3 * 4 = 12"
  3 * 4 = 12

  $ name=나가수
  $ echo '내 이름은 $name 현재 시간은 `date`'
  내 이름은 $name 현재 시간은 `date`
  $ echo "내 이름은 $name 현재 시간은 `date`"
  내 이름은 나가수 현재 시간은 Thu Apr 24 20:56:19 KST 2025
  ```
  - 정리
    1. 작은 따옴표(')는 파일이름 대치, 변수 대치, 명령어 대치를 모두 제한한다.
    2. 큰 따옴표(")는 파일이름 대치만 제한한다.
    3. 따옴표가 중첩되면 밖에 따옴표가 효력을 가진다.
